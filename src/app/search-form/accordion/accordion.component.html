<section>
  <form (ngSubmit)="submitForm(f)" #f="ngForm">
    <div class="card">

      <!-- Accordion Items -->
      <ul class="card-header" (click)="!editing ? (isCollapsed= !isCollapsed) : null">
        <li>
          <button type="button" class="btn fa fa-chevron-right"
            [ngStyle]="{ transform: isCollapsed ? '' : 'rotate(90deg)' }"></button>
        </li>

        <li>{{ savedSearch.datetime_updated | date }}</li>
        <li>
          <span *ngIf="!editing; else editName" class="name" role="button" style="color: #292929">
            {{ inputName || savedSearch.name }}
          </span>

          <!-- Edit savedSearch input -->
          <ng-template #editName>
            <input [(ngModel)]="form.inputName" #inputName="ngModel" name="inputName" required autocomplete="off"
              size="42" [ngClass]="f.form.invalid ? 'edit-name-invalid' :
              'edit-name'" [ngStyle]="{ background: inputName === '' ? 'red' : '' }"
              [value]="f.form.invalid ? 'Name is required' : form.inputName" />
          </ng-template>
        </li>
        <li>
          <span>{{ savedSearch.result_count | number }}</span>
        </li>
        <li (click)="loadOverlays()">
          <button type="button" class="btn">
            LOAD
          </button>
        </li>
      </ul>


      <!-- Accordion Hidden Content Starts Here -->
      <div [collapse]="isCollapsed" [isAnimated]="true">

        <!-- Overlay Colors -->
        <div class="row overlays">
          <span *ngFor="let color of overlayColors">
            <a [ngStyle]="{ 'background': color.color, 'width': '32px', 'height': '5px', 'display': 'inline-block',
            'margin-right': '.063em' }">&nbsp;&nbsp;</a>

          </span>
        </div>

        <!-- Content -->
        <div [ngClass]="{ 'card-body' : !editing, 'card-body-edit-mode': editing  }">
          <div class="description-container">

            <!-- Notifications -->
            <nav class="user-nav">
              <input #inputNotifications="ngModel" [id]="this.savedSearch.name" [(ngModel)]="form.inputNotifications"
                name="inputNotifications" autocomplete="off" type="checkbox" [checked]="inputNotifications"
                (change)="submitForm('checkbox')" />
              <label [for]="this.savedSearch.name" style="margin-left: 0.5rem;
                color: #000">
                Receive notifications
              </label>
            </nav>

            <!-- Description View -->
            <h5 class="desc_subtitle">Description:</h5>
            <div class="description">
              <ng-template #Description>
                <div class="description" innerHTML="{{ form.inputDescription
                  }}"></div>
              </ng-template>

              <!-- Description Editing -->
              <div *ngIf="editing; else Description">
                <textarea #textArea="ngModel" [(ngModel)]="form.inputDescription" name="inputDescription" [rows]="savedSearch.description &&
                  savedSearch.description.length < 200
                  ? 5
                  : savedSearch.description.length > 200 &&
                  savedSearch.description.length < 499
                    ? 6
                    : savedSearch.description.length> 500
                    ? 9
                    : 5
                    " cols="96" class="textarea-edit"
                  style="overflow-y: 'scroll'">{{ form.inputDescription }]</textarea>
              </div>
            </div>

            <!-- EditMode Buttons -->
            <footer class="edit-mode-footer">
              <button class="btn btn-secondary btn-xs" type="button" *ngIf="!editing" (click)="toggleEditing()">
                <i class="fa fa-edit" (click)="toggleEditing()"></i>
                EDIT
              </button>

              <button *ngIf="editing" class="btn btn-success btn-xs" type="submit" [disabled]="f.form.invalid">
                <i class="fa fa-save" (click)="toggleEditing()"></i>
                SAVE CHANGES
              </button>
              &nbsp;
              <button *ngIf="editing" (click)="this.disableEditing()" class="btn btn-primary btn-xs" type="button">
                <i class="fa fa-close"></i> CANCEL
              </button>
              <button (click)="deleteItem()" class="btn btn-danger btn-xs
                  pull-right float-right" type="button">
                <i class="fa fa-trash"></i> DELETE
              </button>
            </footer>


          </div>
        </div>
      </div>
    </div>
  </form>
</section>